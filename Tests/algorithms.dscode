FUNCTION verifyICAO(code):
BEGIN
    IF len(code) == 4 THEN
        FOR letter in code:
            IF isdigit(letter) THEN
                RETURN False
            ENDIF   
        NEXT code
        ENDFOR
    ELSE
        RETURN False
    ENDIF
    RETURN True
END

-----------------

FUNCTION prompt(type, text):
BEGIN
    model = "gpt-3.5-turbo",
    instructions = [
        "role": makePrompt(type),
        "user's prompt": text
        ]
    RETURN response
END

-------------------------

FUNCTION makePrompt(type):
BEGIN
    IF type == Route THEN
        prompt = (
        "Your role is to generate the best possible route.
        Display in ICAO format. 
        Current flight data is as follows: {input relevant data from .json file}. 
        Justify your response.
        Your output should strictly have the following layout: LAYOUT"
        )
        RETURN prompt

    ELSEIF type == Brief THEN
        prompt = (
        "Your role is to generate a complete flight brief.
        Current flight data is as follows: {input relevant data from .json file}. 
        All Flight data should be displayed in your response.
        consider Threat Error and Management in your respone.
        Your output should strictly have the following layout: LAYOUT"
        )
        RETURN prompt
    
    #and so on...
    ENDIF    
END

------------------------------

FUNCTION fetchAirportName(code):
BEGIN
    IF verifyICAO(code) THEN

        headers = {
            "x-openaip-api-key": api_key_openaip
        }
        params = {
            "search": str(code)
        }
        url = "https://api.core.openaip.net/api/airports"

        response = requests.get(url, headers=headers, params=params)

        data = response.json()
        airport = data["items"][0]

        *to be parsed, then:*

        Code = airport["ICAOcode"]
        Name = airport["name"]

        IF error ocurred OR Code != code THEN
        RETURN False

        ELSEIF Code == code THEN
            RETURN name
        ENDIF
    ENDIF
END

-----------------------------------------

FUNCTION fetchMETAR(code):
BEGIN
    IF verifyICAO(code) THEN
        url = (f"https://api.checkwx.com/metar/{code}/decoded")
        response = request.get(url).json()
        print(response)
        *to be parsed and appended to .json data file*
    ENDIF
END

FUNCTION fetchTAF(code):
BEGIN
    IF verifyICAO(code) THEN
        url = (f"https://api.checkwx.com/taf/{code}/decoded")
        response = request.get(url).json()
        print(response)
        *to be parsed and appended to .json data file*
    ENDIF
END

-------------------------------------------

FUNCTION updateJSON(key, value):
BEGIN
    with open("data.json", "r") as file:
    data = json.load(file)
    data[key] = value
    with open("data.json", "w") as file:
    json.dump(data, file, indent=4)
END

---------------------------------------------

FUNCTION NotamDecoder()
BEGIN
    
END

 Q)EGTT/QOBCE/IV/M/AE/000/002/5050N00016W001
 B)2505120847 C)2508111900
 E)CRANE OPERATING PSN 504957N 0001607W (SOUTH SHOREHAM) MAX
 HEIGHT 136FT AGL/ 142FT AMSL

 C4626/25 NOTAMN
Q) EGTT/QOBCE/IV/M/AE/000/002/5050N00016W001
A) EGTT
B) 2505120847
C) 2508111900
E) CRANE OPERATING PSN 504957N 0001607W (SOUTH SHOREHAM) MAX HEIGHT 136FT AGL/ 142FT AMSL

----------------------------------------------

FUNCTION CheckSaved():
BEGIN    
    with open("data.json", "r") as file:
    data = json.load(file)
    IF data["saved"] == False THEN
        RETURN False
    ELSE
        RETURN True
    ENDIF
END